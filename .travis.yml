sudo: false
dist: trusty
branches:
  except: release

language: php
matrix:           ###### ONLY ONE WITH FULL TESTING WITH IS 7.3 OTHERS ARE ALL STATIC ANALYSIS ONLY ######
  include:
    - stage: test
      name: "Full test with PHP 7.4"
      php: 7.4
      before_script:  
        - travis_retry composer self-update
        - composer require mediawiki/oauthclient
        - '! find . -type f -name "*.php" -exec php -d error_reporting=32767 -l {} \; 2>&1 >&- | grep "^"'
      script: phpunit
    - name: "Full test with PHP 8"
      php: nightly
      before_script:  
        - travis_retry composer self-update
        - '! find . -type f -name "*.php" -exec php -d error_reporting=32767 -l {} \; 2>&1 >&- | grep "^"'
      script: phpunit
    - name: Avoid success
      php: 9.9.9
      script: phpunit

git:
  depth: 21
  
